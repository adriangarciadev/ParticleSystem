(()=>{"use strict";class t{static getRandom(t,e){return Math.random()*(e-t)+t}static randomTranslation(t,i){return e.getRandom(t,i)}static watchDelta(t){return t>30?17:t}static lerp(t,e,i){return t*(1-i)+e*i}}class e{static rotateVector(t,e){t.x=t.x*Math.cos(e)-t.y*Math.sin(e),t.y=t.x*Math.sin(e)+t.y*Math.cos(e)}static scaleVector(t,e){t.x=t.x*e,t.y=t.y*e}equals(t){return this.x==t.x&&this.y==t.y}isZero(){return 0==this.x&&0==this.y}translateInto(t,e){t.x=this.x+e.x,t.y=this.y+e.y}rotateInto(t,e){t.x=this.x*Math.cos(e)-this.y*Math.sin(e),t.y=this.x*Math.sin(e)+this.y*Math.cos(e)}scaleInto(t,e){t.x=this.x*e,t.y=this.y*e}transformInto(t,e){t.x=this.x*Math.cos(e.rotation)-this.y*Math.sin(e.rotation),t.y=this.x*Math.sin(e.rotation)+this.y*Math.cos(e.rotation),t.x=t.x*e.scale.x,t.y=t.y*e.scale.y,t.x+=e.translation.x,t.y+=e.translation.y}transformIntoValues(t,e,i){t.x=this.x*Math.cos(e.rotation.getValue(i))-this.y*Math.sin(e.rotation.getValue(i)),t.y=this.x*Math.sin(e.rotation.getValue(i))+this.y*Math.cos(e.rotation.getValue(i)),t.x=t.x*e.scale.getValue(i).x,t.y=t.y*e.scale.getValue(i).y,t.x+=e.translation.getValue(i).x,t.y+=e.translation.getValue(i).y}constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}add(t){this.x+=t.x,this.y+=t.y}addXY(t,e){this.x+=t,this.y+=e}addInto(t,e){this.x=t.x+e.x,this.y=t.y+e.y}copy(){return new e(this.x,this.y)}copyInto(t){this.x=t.x,this.y=t.y}static getRandom(i,s){return i&&s?i.x>s.x||i.y>s.y?(console.error("Trying to generate a random number with the wrong parameters, min is greater than max for example\n a Default vector has been created please correct the inputs"),new e(0,0)):new e(t.getRandom(i.x,s.x),t.getRandom(i.y,s.y)):(console.error("min or max are not defined please correct your inputs"),new e(0,0))}lerpInto(e,i,s){this.x=t.lerp(e.x,i.x,s),this.y=t.lerp(e.y,i.y,s)}}e.Zero=new e(0,0);class i{constructor(t,e,i){this.r=t,this.g=e,this.b=i}getRGB(){return"rgb("+ +this.r+","+ +this.g+","+ +this.b+")"}static hexToRGB(t){let e=0,s=0,a=0;return 4==t.length?(e="0x"+t[1]+t[1],s="0x"+t[2]+t[2],a="0x"+t[3]+t[3]):7==t.length&&(e="0x"+t[1]+t[2],s="0x"+t[3]+t[4],a="0x"+t[5]+t[6]),new i(parseInt(e),parseInt(s),parseInt(a))}}class s{constructor(){}generate(){console.error("Please override me called from vector generator")}}class a extends s{constructor(t,e){super(),this.min=t,this.max=e}generate(){return e.getRandom(this.min,this.max)}}class r{constructor(){}generate(){console.error("Please override me called from Color Generator")}}class n extends r{constructor(t,e){super(),this.min=i.hexToRGB(t),this.max=i.hexToRGB(e)}generate(){return new i(t.getRandom(this.min.r,this.max.r),t.getRandom(this.min.g,this.max.g),t.getRandom(this.min.b,this.max.b)).getRGB()}}class l{constructor(){}generate(){console.error("Please override me called from Scalar Generator")}}class o extends l{constructor(t,e){super(),this.min=t,this.max=e}generate(){return t.getRandom(this.min,this.max)}}class h{constructor(t,i){this._PS=i,this._delta=0,this.TTL=t.TTL,this.elapsed=t.elapsed||0,this.velocity=t.velocity||new e(0,0),this.angularSpeed=t.angularSpeed,this.scaleVelocity=t.scaleVelocity,this.trace=t.trace||null,this.creationTime=performance.now(),this.currTime=performance.now(),this.strokeStyle=t.strokeStyle||"#000000FF",this.fillStyle=t.fillStyle,this.timelineOffset=t.timelineOffset||0,this.timeLineElapsed=0,this.isPlaying=t.autoplay||!0,this.Transform=t.Transform}timelinePlay(){this.isPlaying=!0}timelineStop(){this.isPlaying=!1}timelineRewind(){this.timeLineElapsed=0}timeLineSetTime(t){this.timeLineElapsed=t}updateTranslation(){this.Transform.translation.dynamic.addXY(this.velocity.x*this._delta/1e3,this.velocity.y*this._delta/1e3)}updateRotation(){this.Transform.rotation.dynamic+=this.angularSpeed*this._delta/1e3}updateScale(){this.Transform.scale.dynamic.addXY(this.scaleVelocity.x*this._delta/1e3,this.scaleVelocity.y*this._delta/1e3)}updateTransforms(){this.updateTranslation(),this.updateRotation(),this.updateScale()}tick(){this._delta=performance.now()-this.currTime,this._delta=t.watchDelta(this._delta),this.elapsed+=this._delta,this.isPlaying&&(this.timeLineElapsed+=this._delta),this.currTime=performance.now(),this._PS.context.lineWidth=10,this._PS.hasCanvas()&&this._PS.hasContext()&&(this.updateTransforms(),this.trace.tick(this),"function"==typeof this.fillStyle?this._PS.context.fillStyle=this.fillStyle(this.elapsed):this._PS.context.fillStyle=this.fillStyle,this._PS.context.fill(),"function"==typeof this.strokeStyle?this._PS.context.strokeStyle=this.strokeStyle(this.elapsed):this._PS.context.strokeStyle=this.strokeStyle,this._PS.context.stroke())}}class c{constructor(t,e,i){this.val=t,this.dynamic=e,this.timeline=i}getValue(t){console.error("has to be implemented")}getbase(){console.error("has to be implemented")}getTimelineValue(t){console.error("has to be implemented")}}class m extends c{constructor(t,e,i=null){super(t,e,i)}getValue(t=0){return this.timeline?this.val=this.dynamic+this.timeline.getValue(t):this.val=this.dynamic,this.val}}class d extends c{constructor(t,e,i=null){super(t,e,i)}getValue(t=0){return this.timeline?this.val.addInto(this.dynamic,this.timeline.getValue(t)):this.val.copyInto(this.dynamic),this.val}}class u{constructor(t){this._delta=0,this.elapsed=0,this.currTime=performance.now(),this.parameters=t,this.maxParticles=t.maxParticles||5,this.canvas=t.canvas||null,this.context=this.canvas.getContext("2d")||null,this.generationSpeed=t.generationSpeed||5,this.generationAllowance=this.generationSpeed,this.particles=[],this.particleGlobalIndex=0}hasCanvas(){return null!=this.canvas}hasContext(){return null!=this.context}tick(){this._delta=performance.now()-this.currTime,this._delta=t.watchDelta(this._delta),this.elapsed+=this._delta,this.currTime=performance.now(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var e=0;e<this.particles.length;e++)this.particles[e].tick(),0!=this.particles[e].TTL&&this.particles[e].elapsed>=this.particles[e].TTL&&(this.particles[e]._PS=null,this.particles.splice(e,1));for(;this.particles.length<this.maxParticles&&this.generationAllowance>1;)this.particleGlobalIndex++,this.particles.push(this._generateParticle(this.parameters,this.particles.length)),this.generationAllowance--;this.generationAllowance+=this.generationSpeed*this._delta/1e3}_handleVectorValue(t,i,a=""){return t?t instanceof e?t.copy():t instanceof s?t.generate():t instanceof class{constructor(t,e){this.f=t,this.param=e}}?(t.param.context=this,t.f(t.param)):void console.error(a):i.copy()}_handleScalarValue(t,e,i=""){return t?"number"==typeof t?t:t instanceof l?t.generate():t instanceof class{constructor(t,e){this.f=t,this.param=e}}?(console.error("not implemented yet"),e):void console.error(i):e}_handleColorValue(t,e="#000000",i){return t?"string"==typeof t?t:t instanceof r?t.generate():t instanceof class{constructor(t,e){this.f=t,this.param=e}}?e:void console.error(i):e}_generateParticle(t,i){var s={TTL:this._handleScalarValue(t.TTL,0),elapsed:t.elapsed||0,velocity:this._handleVectorValue(t.initialVelocity,new e(0,0)),angularSpeed:this._handleScalarValue(t.angularSpeed,0,"ERROR WITH ANGULAR SPEED"),scaleVelocity:this._handleVectorValue(t.scaleVelocity,new e(0,0)),trace:t.trace,Transform:{translation:new d(new e(0,0),this._handleVectorValue(t.initialPosition,new e(0,0)),t.translationTimeline||null),rotation:new m(0,this._handleScalarValue(t.initialRotation,0),t.rotationTimeline||null),scale:new d(new e(0,0),this._handleVectorValue(t.initialScale,new e(1,1)),t.scaleTimeline||null)},strokeStyle:t.strokeStyle||"#000000FF",fillStyle:this._handleColorValue(t.fillStyle,"#000000")};return new h(s,this)}}class y extends class{constructor(){}}{constructor(t){super(),this.img=t.img,this.maxSprites=t.maxSprites||1,t.frameWidth?this.frameWidth=t.frameWidth:(console.error("set the frame width correctly"),this.frameWidth=0),t.frameHeight?this.frameHeight=t.frameHeight:(console.error("set the frame height correctly"),this.frameHeight=0),this.ncols=t.ncols||1,this.nrows=t.nrows||1,this.rotateFromCenter=t.rotateFromCenter||!0,this.autoplay=t.autoplay||!0,this.loop=!0,this.frameTime=t.frameTime||200,this.currentSprite=t.curFrame||0,this.maxTime=1800,this.elapsed=0}setFrame(t){this.currentSprite=t}tick(t){this.autoplay&&(this.elapsed=t.elapsed);var e=t._PS.context;e.translate(t.Transform.translation.getValue(t.elapsed).x,t.Transform.translation.getValue(t.elapsed).y),e.scale(t.Transform.scale.getValue(t.elapsed).x,t.Transform.scale.getValue(t.elapsed).y),e.rotate(t.Transform.rotation.getValue(t.elapsed)),this.loop?this.currentSprite=Math.floor(this.elapsed/this.frameTime)%this.maxSprites:this.currentSprite=Math.floor(this.elapsed/this.frameTime),e.drawImage(this.img,this.currentSprite%this.ncols*this.frameWidth,Math.floor(this.currentSprite/this.ncols)*this.frameHeight,this.frameWidth,this.frameHeight,this.rotateFromCenter?-this.frameWidth/2:0,this.rotateFromCenter?-this.frameHeight/2:0,this.frameWidth,this.frameHeight),e.setTransform(1,0,0,1,0,0)}}console.log("TESTING THIS SHIT 2");let p=new e(5,5);console.log(p),document.addEventListener("DOMContentLoaded",(function(){new a(new e(0,0),new e(100,100));let t=new o(-Math.PI,Math.PI),s=new n("#fcf727","#ff0000");new i(0,0,0),new a(new e(-400,0),new e(0,800)),new h({});var r=new y({img:document.getElementById("fire-fx"),frameWidth:700,frameHeight:393});console.log("generator : "+JSON.stringify(r));var l=document.createElement("canvas");l.width=1600,l.height=1200,document.querySelector("body").prepend(l),l.style.position="fixed",l.style.zIndex="400";var c={trace:r,maxParticles:45,generationSpeed:1e3,TTL:6e3,initialPosition:new a(new e(-400,0),new e(0,800)),fillStyle:s,strokeStyle:function(t){return"transparent"},canvas:l,initialVelocity:new a(new e(100,-400),new e(500,400)),initialScale:new e(5,5),angularSpeed:t},m=new u(c);!function t(){m.tick(),window.requestAnimationFrame(t)}()}))})();